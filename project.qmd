---
title: "Is Ignorance Truly Bliss*? Relationship between Education, Gender & Happiness"
format:
  html:
    code-fold: true
    code-summary: "Show the code"
    css: styles.css
    code-copy: true
    embed-resources: true
    
  pdf: 
    colorlinks: true
    papersize: a4
    fontsize: 11pt
    margin-left: 2cm
    margin-right: 2cm
    margin-top: 2cm
    margin-bottom: 2cm

---

# 1. Project Overview and Scope ![](assets/images/scope.png){fig-align="left" width="0.3in"}

The phrase "[**Ignorance is bliss**]{.highlight-plum} is a perspective that most of us have come across at least once, and sometimes even found meaningful. Naturally, individuals may have developed and educated themselves regardless of their formal educational background, gaining the ability to view life from different perspectives. However, in this study, the concept of 'ignorance' that I aim to focus on is independent of such interpretations. Instead, it refers to the relationship between a person's level of education and their happiness, as well as how this relationship differs between men and women.

[**Problem Definition**]{.highlight-plum}: Life satisfaction among individuals may vary depending on factors such as gender and education level. Therefore, it is necessary to conduct an analysis to examine the direction and magnitude of this interaction and to observe how happiness levels change based on individuals’ gender and educational background. [**The aim**]{.highlight-plum} of this study is to reveal whether there is a significant relationship between educational attainment and happiness levels in this context.

# 2. Data![](assets/images/data.png){fig-align="left" width="0.5in"}

## 2.1 Data Source

In this study, data obtained from the following links conducted by the Turkish Statistical Institute (TURKSTAT) has been used.

-   [Life Satisfaction Survey \[1\]](https://www.tuik.gov.tr/)

-   [Population Statistics Portal \[2\]](https://nip.tuik.gov.tr/)

## 2.2 General Information About Data

["**education**"]{.highlight-plum} dataset: This dataset contains the number of individuals by gender and educational status for each province between 2008 and 2023.A small part of the dataset is shown below.

```{r}

#libraries
library(readxl)
library(ggplot2)
library(tidyverse)
library(dslabs)
library(ggthemes)
library(ggrepel)
library(dplyr)
library(gganimate)
library(sf)
library(viridis)
library(broom)
library(htmlwidgets)
library(knitr)
library(gifski)
library(tidytext)
library(nortest)

#Import education dataset

#education <- read_excel("education.xlsx")
#save(education,file = "education.RData")
load("education.RData")
head(education)

```

["**byeducation**]{.highlight-plum}" dataset: This dataset contains the percentages of general happiness levels by educational status between 2004 and 2024. A small part of the dataset is shown below.

```{r}
#Import byeducation dataset
#byeducation <- read_excel("byeducation.xlsx")
#save(byeducation,file = "byeducation.RData")
load("byeducation.RData")
head(byeducation)
```

["**bygender**"]{.highlight-plum} data set: This dataset contains the percentages of general happiness levels by gender between 2003 and 2024. A small part of the dataset is shown below.

```{r}
#Import bygender dataset
#bygender <- read_excel("bygender.xlsx")
#save(bygender,file = "bygender.RData")
load("bygender.RData")
head(bygender)
```

## 2.3 Reason of Choice

Even in this century, the distinction between women and men is still evident in many areas in Turkey. Undoubtedly, educating individuals is the most effective way to change the position of women in society. And perhaps, in this way, a society that has educated itself reaches the most important value for a person: [**happiness**]{.highlight-plum}.

## 2.4 Preprocessing

The datasets used in this study will be merged to facilitate the analysis and will be organized in a way that allows easy processing by the program. If needed during the later stages of the analysis, additional datasets may be incorporated into the study. Different preprocessing steps have been applied to each dataset. The specific modifications made to each dataset are listed below in bullet points.

**Preprocessing for "[education](https://github.com/emu-hacettepe-analytics/emu660-spring2025-ecavusgil)" dataset;**

-   The presence of missing values (NA) is examined, and necessary preprocessing steps are applied if they exist.

-   The education levels ("Educational_Status") in the "education" dataset (10 levels) were aligned with those in the 'byeducation' dataset (5 levels).

-   Irrelevant information has been removed from the dataset to simplify it. For example, entries such as "Unknown" and "Total" in the "Educational_Status" column have been excluded.

```{r}
#changes in education dataset
#head(education)
#str(education)

 sum(is.na(education))

 education<- education |> filter(!Educational_Status %in% c("Bilinmeyen","Toplam"))|>
  mutate(Educational_Status = case_when(
    Educational_Status %in% c("Okuma yazma bilmeyen", "Okuma yazma bilen fakat bir okul bitirmeyen") ~ "No School Completed",
    Educational_Status== "İlkokul" ~ "Primary School",
    Educational_Status %in% c("Ortaokul veya dengi meslek okulu", "İlköğretim") ~ "Primary Education or Junior High School",
    Educational_Status== "Lise veya dengi meslek okulu" ~ "High School or Equivalent",
    Educational_Status %in% c("Yüksekokul veya fakülte", "Yüksek lisans ve üzeri") ~ "Higher Education",
    TRUE ~ as.character(Educational_Status))) 
  
  education<- education |>  group_by(Year,Province,Educational_Status) |>
  summarise(
    Total=sum(Total,na.rm = TRUE),
    Male=sum(Male,na.rm = TRUE),
    Female=sum(Female,na.rm = TRUE),
    Percentage_Male=sum(Percentage_Male,na.rm = TRUE),
    Percentage_Female=sum(Percentage_Female,na.rm = TRUE),
    .groups = "drop"
  )
  
education$Educational_Status<-factor(education$Educational_Status,levels= c("No School Completed","Primary School","Primary Education or Junior High School","High School or Equivalent","Higher Education"),ordered = TRUE) 



head(education)
```

The variables and their corresponding value ranges in the finalized "education" dataset are defined as follows:

```{r}
 str(education)
```

-   [*Year*]{.underline}: The year of the study (ranging from 2008 to 2023).

-   [*Province*]{.underline}: Name of the province (81 provinces in total).

-   [*Educational_Status*]{.underline}: Education level ("No School Completed," "Primary School," "Primary Education or Junior High School," "High School or Equivalent," "Higher Education").

-   [*Total*]{.underline}: Total number of individuals in a given year, province, and education level.

-   [*Male*]{.underline}: Number of males in a given year, province, and education level.

-   [*Female*]{.underline}: Number of females in a given year, province, and education level.

-   [*Percentage_Male*]{.underline}: Percentage of males in a given year, province, and education level.

-   [*Percentage_Female*]{.underline}: Percentage of females in a given year, province, and education level.

Descriptive statistics for variables are presented below.

```{r}
 summary(education)
```

**Preprocessing for "[byeducation](https://github.com/emu-hacettepe-analytics/emu660-spring2025-ecavusgil)" dataset;**

-   The presence of missing values (NA) is examined, and necessary preprocessing steps are applied if they exist.

-   The "byeducation" dataset is updated to include data from 2008 to 2023, in accordance with the 'education' dataset, which contains information for the same years.

-   The variable "Happiness_Level", which indicates the level of happiness, is defined as a factor variable with three levels.

```{r}
#changes in byeducation dataset
#head(byeducation)
#str(byeducation)


sum(is.na(byeducation))

byeducation<- byeducation |> filter(Year %in% 2008:2023)
byeducation$Happiness_Level<-factor(byeducation$Happiness_Level,levels= c("Unhappy","Neither happy nor unhappy","Happy"),ordered = TRUE) 

  
head(byeducation)
```

The variables and their corresponding value ranges in the finalized "byeducation" dataset are defined as follows:

```{r}
 str(byeducation)
```

-   [*Year*]{.underline}: The study year (ranging from 2003 to 2008).

-   [*Happiness_Level*]{.underline}: Levels of happiness ("Unhappy," "Neither Happy nor Unhappy," "Happy").

-   [*No School Completed*]{.underline}: The percentage of individuals with no formal education for a given year and happiness level.

-   [*Primary School*]{.underline}: The percentage of individuals who completed primary school for a given year and happiness level.

-   [*Primary Education or Junior High School*]{.underline}: The percentage of individuals who completed primary education or junior high school for a given year and happiness level.

-   [*High School or Equivalent*]{.underline}: The percentage of individuals who completed high school or its equivalent for a given year and happiness level.

-   [*Higher Education*]{.underline}: The percentage of individuals who completed university or higher education for a given year and happiness level.

Descriptive statistics for the variables are as follows:

```{r}
 summary(byeducation)
```

**Preprocessing for "[bygender](https://github.com/emu-hacettepe-analytics/emu660-spring2025-ecavusgil)" dataset;**

-   The presence of missing values (NA) is examined, and necessary preprocessing steps are applied if they exist.

-   The "bygender" dataset is updated to include data from 2008 to 2023, in accordance with the 'education' dataset, which contains information for the same years.

-   Happiness levels in this dataset were originally assessed on five different levels. For the consistency of the analysis, the levels of happiness have been redefined and consolidated into three levels, similar to the categorization in the "bygender" dataset.

```{r}
#changes in bygender dataset
#head(bygender)
#str(bygender)

sum(is.na(byeducation))

bygender <- bygender |> filter(Year %in% 2008:2023)|>
  mutate(Happiness_Level = case_when(
    Happiness_Level %in% c("Very happy", "Happy") ~ "Happy",
    Happiness_Level %in% c("Very unhappy", "Unhappy") ~ "Unhappy",
    Happiness_Level== "Neither happy nor unhappy" ~ "Neither happy nor unhappy",
    TRUE ~ as.character(Happiness_Level))) 
  
  bygender<- bygender |> group_by(Year,Happiness_Level)|> 
  summarise(
    Total=sum(Total,na.rm = TRUE),
    Male=sum(Male,na.rm = TRUE),
    Female=sum(Female,na.rm = TRUE),
    .groups = "drop"
  )

bygender$Happiness_Level<-factor(bygender$Happiness_Level,levels= c("Unhappy","Neither happy nor unhappy","Happy"),ordered = TRUE) 

  
head(bygender)
```

The variables and their corresponding value ranges in the finalized "bygender" dataset are defined as follows:

```{r}
 str(bygender)
```

-   [*Year*]{.underline}: The study year (ranging from 2003 to 2008).

-   [*Happiness_Level*]{.underline}: Levels of happiness ("Unhappy," "Neither Happy nor Unhappy," "Happy").

-   [*Total*]{.underline}: The percentage of individuals for each year and happiness level.

-   [*Male*]{.underline}: The percentage of males for each year and happiness level.

-   [*Female*]{.underline}: The percentage of females for each year and happiness level.

Descriptive statistics for the variables are as follows:

```{r}
 summary(bygender)
```

# 3. Analysis ![](assets/images/analysis.png){fig-align="left" width="0.5in"}

## 3.1 Exploratory Data Analysis

At this stage of the analysis, visualizations will be used to explore the data in more detail, aiming to gain insights into the characteristics of different variables. To ensure a more structured analysis process, the datasets will be examined one by one in sequence. For each dataset, a set of questions will be explored with the aim of gaining deeper understanding and shedding light on key patterns.

To provide a more detailed analysis of the "education" dataset, the following questions will be examined.

Examining the provinces and years with a high number of individuals holding higher education degrees or no formal education may offer meaningful insights into educational disparities. [***Question: Which are the top 10 provinces with the highest number of university graduates, and which are the top 10 provinces with the highest number of individuals who have not completed any formal education?***]{.highlight-plum}

Based on the graphs presented below, the following observations can be made:

-   The number of individuals with higher education has steadily [**increased**]{.highlight-red} over the years.

-   The provinces with the highest levels of higher education attainment remain relatively consistent over time, with major cities such as [**Istanbul**]{.highlight-red}, [**Ankara**]{.highlight-red}, and [**Izmir**]{.highlight-red} standing out.

-   This trend may be attributed to both the larger populations in these cities and the higher concentration of universities located there.

```{r,echo=FALSE, eval=is_html_output()}

#Turkiye Map
if (interactive()){
#file.choose()
turkiye <- st_read("C:\\Users\\Ece Cavusgil\\Desktop\\ece\\OKUL\\end yüksek lisans\\1.dönem\\analitik karar\\emu660-spring2025-ecavusgil\\gadm41_TUR_shp\\gadm41_TUR_1.shp")

unique(turkiye$NAME_1)
turkiye <- turkiye |>
  mutate(il = tolower(NAME_1))

higher_education <- education |>
  filter(grepl("Higher Education", Educational_Status, ignore.case = TRUE)) |>
          mutate(il = tolower(Province),
           il = case_when(
           il == "ağri" ~ "ağrı",
           il == "elaziğ" ~ "elazığ",
           il == "eskişehir" ~ "eskisehir",
           il == "gümüşhane" ~ "gümüshane",
           il == "ığdır" ~ "ığdır",
           il == "k.maras" ~ "kahramanmaraş",
           il == "muğla" ~ "mugla",
           il == "muş" ~ "mus",
           il == "nevşehir" ~ "nevsehir",
           il == "niğde" ~ "nigde",
           il == "tekirdağ" ~ "tekirdag",
           il == "uşak" ~ "usak",
           il == "zonguldak" ~ "zinguldak",
           il == "şanliurfa" ~ "sanliurfa",
           il == "şirnak" ~ "sirnak",
           il == "kırıkkale" ~ "kırıkkale",
           il == "kirşehir" ~ "kirsehir",
           il == "bartin" ~ "bartın",
           il == "afyonkarahisar" ~ "afyon",
           TRUE ~ il
         ))



harita_veri <- left_join(turkiye, higher_education, by = "il")
na.omit(harita_veri)
min_value <- min(harita_veri$Year, na.rm = TRUE)
max_value <- max(harita_veri$Year, na.rm = TRUE)

p <- ggplot(harita_veri) +
  geom_sf(aes(fill = Total/1000), color = "white") +
  scale_fill_viridis(option = "viridis", name = "Higher Education (10³)",direction = -1) +
  labs(title = "Top 10 Provinces by Higher Education Attainment For Year: {frame_time}", caption = "Kaynak: education.xlsx") +
  theme_minimal() +
  transition_time(as.integer(Year))+
  ease_aes("linear")

#anim<-animate(p, fps = 2, duration = 6, width = 800, height = 600, renderer = gifski_renderer("animation.gif"))


#anim_save("animation.gif", animation = anim)

# HTML için animasyon .gif olarak kaydet
animate(p, fps = 2, duration = 6, width = 800, height = 600, renderer = gifski_renderer("animation.gif"))

# --- Sabit Görsel Oluştur (PDF için) ---
sabit_yil <- 2023
harita_tek_yil <- harita_veri |> filter(Year == sabit_yil)

p_static <- ggplot(harita_tek_yil) +
  geom_sf(aes(fill = Total / 1000), color = "white") +
  scale_fill_viridis(option = "viridis", name = "Higher Education (10³)", direction = -1) +
  labs(title = paste("Top 10 Provinces by Higher Education Attainment For ", sabit_yil),
       caption = "Kaynak: education.xlsx") +
  theme_minimal()

ggsave("higher_education_static.png", plot = p_static, width = 8, height = 6, dpi = 300)
}
include_graphics("animation.gif")
```

```{r}
include_graphics("higher_education_static.png")
#Top 10 Provinces by Higher Education Attainment (Each Year)
education |> 
  filter(Educational_Status == "Higher Education") |> 
  group_by(Year) |> 
  slice_max(order_by = Total, n = 10) |> 
  ungroup() |> 
  ggplot(aes(x = reorder(Province, Total), y = Total / 1000,width = 0.5)) +
  geom_bar(stat = "identity", fill = "orange") +
  coord_flip() +
  facet_wrap(~Year, scales = "free_y") +
  labs(
    title = "Top 10 Provinces by Higher Education Attainment (Each Year)",
    x = "Province",
    y = "Total (10³)"
  ) +
  theme_minimal()+
  theme(axis.text.x = element_text(angle = 90, hjust = 1, size = 6),axis.text.y= element_text(size=5.5))

```

Based on the graphs presented below, several observations can be made:

-   Over the years, the number of individuals with no formal education has generally increased, reaching its [**peak in 2022**]{.highlight-red} before starting to decline.

-   The provinces appearing in the top 10 list for individuals with no education often overlap with those that also rank high in higher education attainment. A major reason for this could be the concentration of Turkey's population in these large metropolitan areas.

```{r}

education |> 
  filter(Educational_Status == "No School Completed") |> 
  group_by(Year) |> 
  slice_max(order_by = Total, n = 10) |> 
  ungroup() |> 
  ggplot(aes(x = reorder(Province, Total), y = Total/1000 ,width = 0.5)) +
  geom_bar(stat = "identity", fill = "darkgreen") +
  coord_flip() + 
  facet_wrap(~Year, scales = "free_y") +
  labs(
    title = "Top 10 Provinces by No School Attainment (Each Year)",
    x = "Province",
    y = "Total (10³)"
  ) +
  theme_minimal()+
  theme(axis.text.x = element_text(angle = 90, hjust = 1, size = 6),axis.text.y= element_text(size=5.5))


```

After examining the number of individuals with no formal education and those with higher education across provinces, the next step involves incorporating the gender dimension into the analysis. [***Question: What does the comparison between female and male proportions tell us about the presumed educational disadvantage faced by women?***]{.highlight-plum}

Below, a series of maps illustrate the percentage of women and men with no formal education across provinces over time. The visualizations show that, in recent years, the number of [**men with no education has begun to surpass that of women**]{.highlight-red} in many provinces.

Does this observation indicate that the educational disadvantage has shifted over time to affect men more significantly?

```{r,echo=FALSE, eval=is_html_output()}

if (interactive()) {

  # Harita verisini oku
  turkiye <- st_read("C:\\Users\\Ece Cavusgil\\Desktop\\ece\\OKUL\\end yüksek lisans\\1.dönem\\analitik karar\\emu660-spring2025-ecavusgil\\gadm41_TUR_shp\\gadm41_TUR_1.shp")

  turkiye <- turkiye |>
    mutate(il = tolower(NAME_1))

  
  no_edu <- education |>
    filter(Educational_Status == "No School Completed") |>
    mutate(il = tolower(Province),
           il = case_when(
           il == "ağrı" ~ "ağrı",
           il == "elaziğ" ~ "elazığ",
           il == "eskişehir" ~ "eskisehir",
           il == "gümüşhane" ~ "gümüshane",
           il == "ığdır" ~ "iğdir",
           il == "k.maras" ~ "kahramanmaraş",
           il == "muğla" ~ "mugla",
           il == "muş" ~ "mus",
           il == "nevşehir" ~ "nevsehir",
           il == "niğde" ~ "nigde",
           il == "tekirdağ" ~ "tekirdag",
           il == "uşak" ~ "usak",
           il == "zonguldak" ~ "zinguldak",
           il == "şanliurfa" ~ "sanliurfa",
           il == "şirnak" ~ "sirnak",
           il == "kırıkkale" ~ "kırıkkale",
           il == "kirşehir" ~ "kirsehir",
           il == "bartin" ~ "bartın",
           il == "afyonkarahisar" ~ "afyon",
           TRUE ~ il
         ))

  no_edu <- no_edu |>
    mutate(gender_dominance = ifelse(Percentage_Female > Percentage_Male, "Female", "Male"))

  
  harita_veri <- left_join(turkiye, no_edu, by = "il")

  
  min_value <- min(harita_veri$Year, na.rm = TRUE)
  max_value <- max(harita_veri$Year, na.rm = TRUE)

  
  p <- ggplot(harita_veri) +
    geom_sf(aes(fill = gender_dominance), color = "white") +
    scale_fill_manual(
      values = c("Female" = "salmon", "Male" = "darkslategray3"),
      name = "Dominant Gender"
    ) +
    labs(
      title = "No School Completed Gender Dominance by Province",
      subtitle = "Year: {frame_time}",
      caption = "Red: Female > Male | Blue: Male >= Female"
    ) +
    theme_minimal(base_size = 14) +
    transition_time(as.integer(Year)) +
    ease_aes("linear")


  # Animasyonu oluştur
  #anim1 <- animate(p, fps = 2, duration = 6, width = 800, height = 600)
 # anim_save("animation1.gif", animation = anim1)
  
  animate(p, fps = 2, duration = 6, width = 800, height = 600, renderer = gifski_renderer("animation1.gif"))

# --- Sabit Görsel Oluştur (PDF için) ---
sabit_yil <- 2023
harita_tek_yil <- harita_veri |> filter(Year == sabit_yil)

p_static <- ggplot(harita_veri) +
    geom_sf(aes(fill = gender_dominance), color = "white") +
    scale_fill_manual(
      values = c("Female" = "salmon", "Male" = "darkslategray3"),
      name = "Dominant Gender"
    ) +
    labs(
      title = "No School Completed Gender Dominance by Province",
      subtitle = "Year: 2023",
      caption = "Red: Female > Male | Blue: Male >= Female"
    ) +
    theme_minimal(base_size = 14) 
    

ggsave("female_male_static.png", plot = p_static, width = 8, height = 6, dpi = 300)
}
include_graphics("animation1.gif")
```

```{r}
include_graphics("female_male_static.png")
```

To further investigate the findings from the map above, we can examine the gender distribution across different education levels (aggregated for all years at the national level) using the chart below.

Contrary to our earlier observation, the chart reveals that [**57.48%**]{.highlight-red} of individuals with no formal education are [**women**]{.highlight-red}.

So, what do these seemingly conflicting results actually tell us?

They suggest that, overall, the number of [**women who have never received any formal education is significantly higher than that of men**]{.highlight-red}, even if recent trends indicate a growing number of uneducated men in certain regions.

```{r}
 education |> group_by(Educational_Status)  |>
  summarise(Male = sum(Male),
            Female = sum(Female)) |> mutate(Total = Male + Female,
         Male = Male / Total * 100,
         Female = Female / Total * 100) |>
  pivot_longer(cols = c("Male", "Female"), names_to = "Gender", values_to = "Percentage") |>
  ggplot(aes(x = Educational_Status, y = Percentage, fill = Gender)) +
  geom_bar(stat = "identity", position = "dodge") +
  labs(title = "Educational vs Gender (Country wise)", x = "Educational Status", y = "Percentage")+geom_text_repel(aes(label =round(Percentage,2)), color = "black", size = 3.5)+
  theme(axis.text.x = element_text(angle = 30, hjust = 1, size = 7))
```

To provide a more detailed analysis of the "byeducation" dataset, the following questions will be examined.

To closely examine this dataset, the first step is to explore the relationship between education levels and life satisfaction. [***Question: Which education level group reports higher life satisfaction, and which one reports the lowest?***]{.highlight-plum}

Based on the results obtained, the following observations can be made:

-   Within a given year, the distribution of education levels across happiness categories shows relatively similar proportions.

-   Individuals with [**higher education**]{.highlight-red} have the [**highest**]{.highlight-red} average life satisfaction "Happy", whereas those with only [**primary school education**]{.highlight-red} report the [**lowest**]{.highlight-red}.

-   Among those who identify as "Unhappy," the [**largest proportion**]{.highlight-red} consists of individuals with [**no formal education**]{.highlight-red}, while the [**smallest**]{.highlight-red} share belongs to those with [**higher education**]{.highlight-red}.

-   Individuals with a high school education or with primary/junior high school education tend to display similar patterns, showing closely aligned averages across the different happiness levels.

```{r}
 byeducation |>
  select(everything()) |>
  pivot_longer(cols = c("No School Completed","Primary  School","Primary Education or Junior High School","High School or Equivalent","Higher Education"), names_to = "Education_Level", values_to = "Percentage") |>ggplot(aes(x = Happiness_Level, y = Percentage, color = Education_Level)) +
  geom_boxplot() +
  labs(title = "Happy percentage vs Education Level",
       x = "Happiness_Level", y = "Percentage (%)", color = "Education_Level") +
  theme_minimal()

  
```

To provide a more detailed analysis of the "bygender" dataset, the following questions will be examined.

To closely examine the dataset, the first step is to explore the relationship between education levels and happiness levels. [***Question: How does the percentage of happiness vary for each gender?***]{.highlight-plum}

Based on the results obtained, the following observations can be made:

-   Within a given year, the distribution of happiness levels across genders shows similar proportions for both men and women.

-   [**Women**]{.highlight-red} report the highest average life satisfaction [**"Happy"**]{.highlight-red}, while men tend to have the lowest average satisfaction.

-   The majority of individuals who identify as [**"Unhappy"**]{.highlight-red} are [**men**]{.highlight-red}.

-   There is a [**notable difference**]{.highlight-red} between the average happiness percentages for men and women, particularly at the [**"Happy" level**]{.highlight-red}.

```{r}
 bygender |> 
  select( everything()) |>
  pivot_longer(cols = c("Male", "Female"), names_to = "Gender", values_to = "Percentage") |>ggplot(aes(x = Happiness_Level, y = Percentage, color = Gender)) +
  geom_boxplot()+
  labs(title = "Happy percentage vs Gender",
       x = "Happiness_Level", y = "Percentage (%)", color = "Gender") +
  theme_minimal()

  
```

## 3.2 Trend Analysis

In this section, the behavior of different variables within the datasets over time will be examined. As in previous sections, the datasets will be analyzed separately, and the time-dependent behavior of the variables will be explored by addressing various research questions.

**Analysis for "education" dataset**

In the previous sections, we examined the top 10 provinces with the highest number of university graduates over different years. As the next step in the analysis, we can investigate the provinces where the rate of university graduates has increased most rapidly. [***Question: In which provinces has the rate of university graduates increased most rapidly?***]{.highlight-plum}

Based on the chart below, the following observations can be made:

-   Consistent with our earlier findings, provinces such as Istanbul and Ankara, which appeared in the previous analysis, are also among the provinces that have shown the fastest growth in the number of individuals with higher education. One possible explanation for this is the large population size of these cities.

-   [**Istanbul**]{.highlight-red}, the province with the highest number of university graduates, has shown a [**steady increase between 2008 and 2023**]{.highlight-red}. Similarly, [**Izmir**]{.highlight-red} has also demonstrated consistent growth.

-   A particularly noteworthy observation is the [**sharp upward trend in Ankara**]{.highlight-red}, especially [**after 2020**]{.highlight-red}, where the growth rate increased significantly. A similar observation can be made for [**Konya**]{.highlight-red} and [**Bursa**]{.highlight-red}, though the growth rate in these cities is somewhat slower. This rapid increase, particularly after 2020, may be attributed to the growth in the number of universities in these cities and the migration they have received in recent years.

```{r}
univ_trend <- education |>
  filter(Educational_Status == "Higher Education") |>
  mutate(Total = Male + Female)

slope_by_province <- univ_trend %>%
  group_by(Province) %>%
  summarise(slope = coef(lm(Total ~ Year))[2]) %>%
  arrange(desc(slope))

head(slope_by_province, 10)

top_provinces <- slope_by_province %>%
  slice_max(order_by = slope, n = 5) %>%
  pull(Province)

univ_trend %>%
  filter(Province %in% top_provinces) %>%
  ggplot(aes(x = Year, y = Total/1000, color = Province, group = Province)) +  
  geom_smooth(method = "loess", se = FALSE, linewidth = 1.2) +
  labs(title = " Provinces which rate of university graduates increased most rapidly",
       x = "Year", y = "Total Graduates (10³) ") +
  theme_minimal()


```

**Analysis for "bygender" dataset**

In the next step of our analysis, we can consider how life satisfaction has evolved over time for both men and women, based on the previously explored relationship between gender and happiness levels. [***Question: How has life satisfaction changed over time for men and women?***]{.highlight-plum}

Based on the chart below and in line with our earlier findings, the following observations can be made:

-   It appears that women generally report higher levels of happiness than men, supporting the notion that men tend to be more unhappy than women.

-   In [**2016**]{.highlight-red}, a [**decrease**]{.highlight-red} was observed in the percentage of individuals reporting [**high life satisfaction**]{.highlight-red}. This decline is mirrored by an [**increase**]{.highlight-red} in the percentage of individuals identifying as [**"unhappy"**]{.highlight-red} after 2016.

```{r}

bygender_long <- bygender |> 
  pivot_longer(cols = c("Male", "Female"), 
               names_to = "Gender", 
               values_to = "Percentage")
ggplot(bygender_long, aes(x = Year, y = Percentage, color = Gender)) +
  geom_line(size = 1.2) +
  geom_point(linewidth = 2) +
  facet_wrap(~ Happiness_Level) +
  labs(title = "Life Satisfaction Trends by Gender and Level",
       x = "Year", y = "Percentage (%)",
       color = "Gender") +
  theme_minimal()





```

We can conclude that there is a significant difference between men and women in terms of happiness levels. This conclusion can be further developed by examining whether the difference between men and women persists annually. [***Question: Does the difference in life satisfaction between men and women persist annually?***]{.highlight-plum}

Based on the analysis below, the following observations can be made:

-   [**Negative values**]{.highlight-red} indicate that [**women**]{.highlight-red} are generally [**happier**]{.highlight-red} than men.

-   When examining the statistical significance of the difference (i.e., whether the [**difference in happiness between men and women**]{.highlight-red} shows a meaningful trend over time) through linear regression, the [**p-value = 0.046**]{.highlight-red}, which is less than 0.05, indicating that the difference is statistically [**significant**]{.highlight-red}. On average, the difference between men and women in happiness levels [**decreases by 0.24**]{.highlight-red} points per year.

```{r}
mutlu_df <- bygender |> 
  filter(Happiness_Level == "Happy") |> 
  pivot_longer(cols = c(Male, Female), 
               names_to = "Gender", 
               values_to = "Percentage")|>  
  pivot_wider(names_from = Gender, values_from = Percentage)|>
  mutate(Difference = Male - Female)  
  
  ggplot(mutlu_df, aes(x = Year, y = Difference)) +
  geom_line(color = "darkred", size = 1.2) +
  geom_point(size = 2, color = "darkred") +
  geom_hline(yintercept = 0, linetype = "dashed") +
  geom_smooth(method = "lm", se = TRUE, color = "black", linetype = "dotted") +
  labs(title = "Trend of Gender Difference in Happiness Over Time",
       subtitle = "Black dotted line: linear trend",
       x = "Year", y = "Happiness Difference (Male - Female)") +
  theme_minimal()

model <- lm(Difference ~ Year, data = mutlu_df)
summary(model)


```

Similarly, the difference in happiness levels between men and women at the [**"Unhappy" level**]{.highlight-red} has also been examined for statistical [**significance**]{.highlight-red}. According to the results, since [**p = 0.0268**]{.highlight-red}, which is less than 0.05, the difference is statistically significant. On average, the difference between men and women in the "Unhappy" category [**increases by 0.17**]{.highlight-red} points per year.

```{r}
mutsuz_df <- bygender |> 
  filter(Happiness_Level == "Unhappy") |> 
  pivot_longer(cols = c(Male, Female), 
               names_to = "Gender", 
               values_to = "Percentage")|>  
  pivot_wider(names_from = Gender, values_from = Percentage)|>
  mutate(Difference = Male - Female)  
  
  ggplot(mutsuz_df, aes(x = Year, y = Difference)) +
  geom_line(color = "darkred", size = 1.2) +
  geom_point(size = 2, color = "darkred") +
  geom_hline(yintercept = 0, linetype = "dashed") +
  geom_smooth(method = "lm", se = TRUE, color = "black", linetype = "dotted") +
  labs(title = "Trend of Gender Difference in Unhappiness Over Time",
       subtitle = "Black dotted line: linear trend",
       x = "Year", y = "Happiness Difference (Male - Female)") +
  theme_minimal()

model <- lm(Difference ~ Year, data = mutsuz_df)
summary(model)


```

**Analysis for "byeducation" dataset**

We have previously gathered some insights regarding the relationship between education levels and happiness levels in the dataset. As the next step in this analysis, we can consider how life satisfaction has evolved over time for different education levels. Question: How has life satisfaction percentage changed over level of education? [***Question: How has life satisfaction percentage changed over level of education?***]{.highlight-plum}

Based on the analysis provided below, the following observations can be made:

-   The percentage of individuals who report being [**happy**]{.highlight-red} has [**decreased across all education levels**]{.highlight-red} over time.

-   The [**smallest decrease**]{.highlight-red} in happiness levels has been observed among individuals [**without any education**]{.highlight-red}, with an average decrease of just [**0.0089**]{.highlight-red}, which is a very low rate.

-   The education level with the [**greatest decline**]{.highlight-red} in life satisfaction over time is among individuals with [**higher education**]{.highlight-red}. For this group, the happiness percentage has decreased by an average of [**1.369**]{.highlight-red} points per year.

```{r}

edu_happy <- byeducation |>
  filter(Happiness_Level=="Happy")|>pivot_longer(c(`No School Completed`,`Primary  School`,`Primary Education or Junior High School`,`High School or Equivalent`,`Higher Education`),
               names_to  = "Educational_Status",
               values_to = "Percentage") 

edu_happy$Educational_Status <- factor(
  edu_happy$Educational_Status,
  levels = c("No School Completed","Primary  School","Primary Education or Junior High School","High School or Equivalent","Higher Education",order=TRUE)
)
ggplot(edu_happy, aes(x = Year, y = Percentage, color = Educational_Status)) +
 geom_point() +
  geom_smooth(method = "lm", se = FALSE, size = 1.2) +
  labs(title = "Life satisfaction percentage changed over level of education",
       x = "Year", y = "Happy (%)") +
  theme_light()

edu_trends <- edu_happy %>%
  group_by(Educational_Status) %>%
  do(tidy(lm(Percentage ~ Year, data = .))) %>%
  filter(term == "Year") %>%
  arrange(desc(estimate))

edu_trends

```

The same analysis has been conducted for the "Unhappy" happiness level, and the following results were found:

-   The percentage of individuals who identify as [**"Unhappy"**]{.highlight-red} has [**increased**]{.highlight-red} over time for all education levels, [**except for those without any education**]{.highlight-red}.

-   For individuals [**without any education**]{.highlight-red}, the percentage of those who identify as "Unhappy" has decreased over time, with an average [**decrease of 0.065**]{.highlight-red} per year.

-   The education level with the [**largest increase**]{.highlight-red} in the percentage of individuals who identify as [**"Unhappy" over time is higher education**]{.highlight-red}. For this group, the percentage of those who report being "Unhappy" has increased by an average of [**0.45**]{.highlight-red} points per year.

```{r}

edu_unhappy <- byeducation |>
  filter(Happiness_Level=="Unhappy")|>pivot_longer(c(`No School Completed`,`Primary  School`,`Primary Education or Junior High School`,`High School or Equivalent`,`Higher Education`),
               names_to  = "Educational_Status",
               values_to = "Percentage") 

edu_unhappy$Educational_Status <- factor(
  edu_unhappy$Educational_Status,
  levels = c("No School Completed","Primary  School","Primary Education or Junior High School","High School or Equivalent","Higher Education",order=TRUE)
)
ggplot(edu_unhappy, aes(x = Year, y = Percentage, color = Educational_Status)) +
 geom_point() +
  geom_smooth(method = "lm", se = FALSE, size = 1.2) +
  labs(title = "Life satisfaction  percentage changed over level of education",
       x = "Year", y = "Unhappy (%)") +
  theme_light()

edu_trends <- edu_unhappy %>%
  group_by(Educational_Status) %>%
  do(tidy(lm(Percentage ~ Year, data = .))) %>%
  filter(term == "Year") %>%
  arrange(desc(estimate))

edu_trends

```

## 3.3 Model Fitting

In this section, the primary objective of the research will be addressed by statistically examining the relationships between variables that influence individuals' happiness levels, their interconnections, and their association with happiness levels in more detail. Based on the findings, predictive models for the future will be developed. This approach will be carried out, as in previous steps, by answering key questions.

-   [***Question: Is there a significant difference between educational level and happiness level? (using the "byeducation" dataset)***]{.highlight-plum}

According to the Chi-square test, the [**p-value is 2.2e-16**]{.highlight-red}, which is less than 0.05. Therefore, it can be concluded that happiness levels are [**significantly**]{.highlight-red} associated with [**education level**]{.highlight-red}.

```{r}
#
df<- byeducation |> pivot_longer(c(`No School Completed`,`Primary  School`,`Primary Education or Junior High School`,`High School or Equivalent`,`Higher Education`),
               names_to  = "Educational_Status",
               values_to = "Percentage") |>
 mutate(Estimated_Count = round(Percentage * 1000 / 100))
 

summary_table <- df %>%
  group_by(Happiness_Level, Educational_Status) %>%
  summarise(Count = sum(Estimated_Count), .groups = "drop")

contingency_matrix <- summary_table %>%
  pivot_wider(names_from = Happiness_Level, values_from = Count) %>%
  column_to_rownames("Educational_Status") %>%
  as.matrix()
chisq.test(contingency_matrix)

```

-   [***Question: Is there a significant difference between educational level and gender? (using the "bygender" dataset)***]{.highlight-plum}

According to the Chi-square test, the [**p-value is 2.2e-16**]{.highlight-red}, which is less than 0.05. Therefore, it can be concluded that happiness levels are [**significantly**]{.highlight-red} associated with [**gender**]{.highlight-red}.

```{r}
#
df1<- bygender |> pivot_longer(c(Male,Female),
               names_to  = "Gender",
               values_to = "Percentage") |>
 mutate(Estimated_Count = round(Percentage * 1000 / 100))
 

summary_table <- df1 %>%
  group_by(Happiness_Level, Gender) %>%
  summarise(Count = sum(Estimated_Count), .groups = "drop")

contingency_matrix1 <- summary_table %>%
  pivot_wider(names_from = Happiness_Level, values_from = Count) %>%
  column_to_rownames("Gender") %>%
  as.matrix()
chisq.test(contingency_matrix1)

```

-   It has once again been observed that [**happiness level (Happy) is influenced by both education level and gender**]{.highlight-red}. In the next stage of the analysis, separate predictive models were developed to estimate happiness levels based on education and gender variables.

**Education Level-Based Happiness Level Prediction Model;**

A predictive model for estimating the percentage of individuals who report being happy based on education level can be constructed in three different ways:

-   [**Model 1**]{.highlight-red} assumes that happiness is influenced solely by [**education level**]{.highlight-red}.

-   [**Model 2**]{.highlight-red} includes the [**effect of time (year)**]{.highlight-red} in addition to education level.

-   [**Model 3**]{.highlight-red} incorporates the [**interaction**]{.highlight-red} between education level and time.

Based on the results, when comparing the Akaike Information Criterion (AIC) values of the models, [**Model 3**]{.highlight-red} was found to have the [**lowest AIC**]{.highlight-red}, indicating the [**best fit to the data**]{.highlight-red}. This suggests that the [**interaction between education level and year should be included**]{.highlight-red} in the predictive model for estimating happiness levels.

Accordingly, the final model should include the statistically [**significant**]{.highlight-red} education levels — [**Primary Education or Junior High School**]{.highlight-red}, [**High School**]{.highlight-red}, and [**Higher Education**]{.highlight-red} — as well as their [**interactions with the year**]{.highlight-red} variable. Since the "Education_Level" variable is categorical, a reference category is selected when constructing the model, which is typically the first level. In this case, the reference category is the "No School Completed" category. The "Intercept"(β₀) value in the model output represents the average happiness percentage for "No School Completed" category, while the Other coefficients represent the difference between the average happiness percentage of the relevant education level and that of the 'No School Completed' category

The adequacy of the model was validated by analyzing whether the residuals conform to a normal distribution with Q-Q Plot and Anderson-Darling Normality Test.

```{r}
happy_df_byeducation  <- byeducation|>
  pivot_longer(
    cols = -c(Year, Happiness_Level),
    names_to = "Education_Level",
    values_to = "Percentage"
  ) |>
  filter(Happiness_Level == "Happy")|>
mutate(Education_Level = factor(Education_Level, 
                                  levels = c("No School Completed","Primary  School","Primary Education or Junior High School","High School or Equivalent","Higher Education",order=TRUE)
))

model1 <- lm(Percentage ~ Education_Level, data = happy_df_byeducation)
summary(model1)

ggplot(happy_df_byeducation, aes(x = Education_Level, y = Percentage)) +
  geom_boxplot(fill = "darkseagreen2") +
  labs(title = "Happy Percentage vs. Education Level",
       x = "Education Level", y = "Happy(%)") +
  theme_minimal()+
  theme(axis.text.x = element_text(angle = 30, hjust = 1, size = 7))

model2 <- lm(Percentage ~ Education_Level + Year, data = happy_df_byeducation)
summary(model2)

model3 <- lm(Percentage ~ Education_Level * Year, data = happy_df_byeducation)
summary(model3)

AIC(model1, model2, model3)

ggplot(happy_df_byeducation, aes(sample = resid(model3))) +
  stat_qq() +
  stat_qq_line(color = "darkgreen") +
  labs(title = "Normal Q-Q Plot") +
  theme_clean()


residuals <- resid(model3)

ad_test_results <- ad.test(residuals)
print(ad_test_results)
```

**Gender-Based Happiness Level Prediction Model;**

The prediction model for happiness percentages based on gender can be established in three different ways.

-   [**Model 1**]{.highlight-red} assumes that the happiness rate is only affected by [**gender**]{.highlight-red}.

-   [**Model 2**]{.highlight-red} includes the [**effect of time**]{.highlight-red} in the prediction model.

-   [**Model 3**]{.highlight-red} adds the [**interaction**]{.highlight-red} between gender and time to the prediction model.

Based on the results, when the AIC (Akaike Information Criterion) values of the models are compared, it is observed that the model that best explains the data is [**Model 2, which has the lowest AIC value**]{.highlight-red}. Therefore, it can be concluded that the effect of the year should be included in the constructed prediction model.

Thus, in the prediction model for happiness percentage, the significant variables, [**"GenderFemale"**]{.highlight-red} (which takes a value of 0 for Male and 1 for Female) and [**"Year"**]{.highlight-red}, should be [**included**]{.highlight-red}. Since the "Gender" variable is categorical, a reference category is selected when constructing the model, which is typically the first level. In this case, the reference category is the "Male" category. The "Intercept"(β₀) value in the model output represents the average happiness percentage for males, while the "GenderFemale" coefficient indicates the difference in the average happiness percentage between females and males.

The adequacy of the model was validated by analyzing whether the residuals conform to a normal distribution with Q-Q Plot and Anderson-Darling Normality Test.

```{r}
happy_df_bygender  <- bygender|>
  pivot_longer(cols = c("Male", "Female"), 
               names_to = "Gender", 
               values_to = "Percentage")|>
  filter(Happiness_Level == "Happy")|>
mutate(Gender = factor(Gender,levels = c("Male","Female")
))

model1 <- lm(Percentage ~ Gender, data = happy_df_bygender)
summary(model1)

ggplot(happy_df_bygender, aes(x = Gender, y = Percentage)) +
  geom_boxplot(fill = "darkseagreen2") +
  labs(title = "Happy Percentage vs. Gender",
       x = "Gender", y = "Happy (%)") +
  theme_minimal()

model2 <- lm(Percentage ~ Gender+ Year, data = happy_df_bygender)
summary(model2)

model3 <- lm(Percentage ~ Gender * Year, data = happy_df_bygender)
summary(model3)

AIC(model1, model2, model3)

ggplot(happy_df_bygender, aes(sample = resid(model2))) +
  stat_qq() +
  stat_qq_line(color = "darkgreen") +
  labs(title = "Normal Q-Q Plot") +
  theme_clean()


residuals <- resid(model2)

ad_test_results <- ad.test(residuals)
print(ad_test_results)

```

# 4. Results and Key Takeaways ![](assets/images/results.png){fig-align="left" width="0.3in"}

In this study, three different datasets were analyzed to investigate the direction and magnitude of the effects of factors such as gender and educational attainment on individuals’ self-reported happiness. These datasets provide information on the total number of individuals by education level across different provinces of Turkey over the years, as well as gender distribution, and the levels of happiness individuals reported over time based on their education level and gender. The study was conducted using this information.

During the analysis phase, the first step involved examining the structure and trends of the variables to gain more detailed insight into the data. These initial observations were enriched further by exploring how the variables behaved over time. Finally, the effects of the variables on happiness percentages were discussed, and regression models based on gender and education level were developed to predict individuals’ likelihood of reporting happiness.

The key findings from the analysis are summarized below:

-   Over time, [**Istanbul**]{.highlight-red}, [**Ankara**]{.highlight-red}, and [**Izmir**]{.highlight-red} were identified as the provinces with the \[greatest increase in individuals who either had no formal education or had completed university and higher education. While the increase in higher education levels in Istanbul and Izmir was more stable, [**Ankara saw a rapid rise**]{.highlight-red}, especially after 2020. On a national scale, the majority of individuals [**without formal education or with only primary education are women**]{.highlight-red}. In contrast, the opposite is true for [**higher education levels, where men are in the majority**]{.highlight-red}.

-   Individuals who identified themselves as [**happy**]{.highlight-red} were mostly those with [**higher education**]{.highlight-red}, whereas those who identified as [**unhappy**]{.highlight-red} were predominantly individuals [**without any formal education**]{.highlight-red}. However, the percentage of individuals reporting happiness has decreased across all education levels over time. The smallest decrease occurred among those with [**no formal education (−0.0089)**]{.highlight-red}, while the largest decrease was among those with [**higher education (−1.369)**]{.highlight-red}. For individuals reporting unhappiness, the percentage decreased over time only for those [**without education (−0.065)**]{.highlight-red}, while it increased across all other education levels. The highest increase in unhappiness was observed among individuals with [**higher education (+0.45)**]{.highlight-red}.

-   Individuals who identified themselves as [**happy were mostly women**]{.highlight-red}, while those who reported being unhappy were mostly men. In addition, the [**difference**]{.highlight-red} in happiness rates between men and women who reported being happy has [**decreased by an average of 0.24 points per year**]{.highlight-red}. On the other hand, the difference between men and women who reported being unhappy has [**increased by approximately 0.17**]{.highlight-red} points annually.

-   To estimate happiness percentages, various regression models were developed based on gender and education level. Models including both main effects and interaction terms for relevant factors were compared. The best-fitting model was identified based on the Akaike Information Criterion (AIC). In the [**gender-based model**]{.highlight-red}, the inclusion of the time variable (year) alongside [**gender improved the model**]{.highlight-red} fit. In the education-level model, main effects for primary school, high school, and higher education levels, as well as their interactions with time, were included in the model specification.

\*Assistance from ChatGPT was utilized at certain parts of this study.

# References

1.Turkish Statistical Institute (TURKSTAT). "*Life Satisfaction Survey, 2023"*. Retrieved from <https://data.tuik.gov.tr/> (accessed May, 2025)

2\. Turkish Statistical Institute (TURKSTAT).(2024). "*Population Statics Portal, 2024"*. Retrieved from <https://nip.tuik.gov.tr/> (accessed May, 2025)
